<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Google Professional Architect Certification Flashcards</title>
    <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@400;700&display=swap" rel="stylesheet">
    <style>
        :root { --g-blue: #4285F4; --g-red: #DB4437; --g-yellow: #F4B400; --g-green: #0F9D58; --bg: #f1f3f4; }
        body { font-family: 'Roboto', sans-serif; background: var(--bg); display: flex; flex-direction: column; align-items: center; margin: 0; padding-bottom: 50px; }
        header { background: white; width: 100%; text-align: center; padding: 15px; box-shadow: 0 2px 5px rgba(0,0,0,0.1); margin-bottom: 20px; }
        .controls { display: flex; gap: 10px; flex-wrap: wrap; margin-bottom: 20px; }
        .card-container { perspective: 1000px; width: 90%; max-width: 700px; height: 500px; cursor: pointer; }
        .card { position: relative; width: 100%; height: 100%; transform-style: preserve-3d; transition: 0.6s; border-radius: 15px; }
        .card.flipped { transform: rotateY(180deg); }
        .face { position: absolute; width: 100%; height: 100%; backface-visibility: hidden; padding: 30px; border-radius: 15px; background: white; box-shadow: 0 10px 30px rgba(0,0,0,0.1); box-sizing: border-box; overflow-y: auto; }
        .front { border-top: 10px solid var(--g-blue); display: flex; flex-direction: column; justify-content: center; text-align: center; font-size: 1.3rem; }
        .back { transform: rotateY(180deg); border-top: 10px solid var(--g-green); }
        .solution-flow { background: #f8f9fa; padding: 15px; border-radius: 8px; border-left: 5px solid var(--g-green); margin: 15px 0; font-size: 0.95rem; line-height: 1.4; }
        .meta-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 10px; margin-top: 15px; }
        .meta-item { padding: 10px; border-radius: 8px; font-size: 0.85rem; border: 1px solid #ddd; }
        .limit { background: #fffde7; border-color: var(--g-yellow); }
        .challenge { background: #fff5f5; border-color: var(--g-red); }
        .tip { background: #e8f0fe; padding: 12px; border-left: 5px solid var(--g-blue); margin-top: 15px; font-size: 0.9rem; }
        .btn { padding: 12px 24px; border-radius: 25px; border: 1px solid #dadce0; cursor: pointer; background: white; font-weight: 700; font-family: inherit; transition: 0.2s; }
        .btn:hover { background: #f1f3f4; }
        .next { background: var(--g-blue); color: white; border: none; }
        .next:hover { background: #3367d6; }
        #stat { margin-top: 15px; font-weight: 700; color: #555; }
        .cat-tag { font-size: 0.75rem; color: var(--g-blue); font-weight: 700; text-transform: uppercase; margin-bottom: 10px; }
        
        /* New Copy Button Style */
        .copy-btn {
            float: right;
            padding: 5px 12px;
            font-size: 0.7rem;
            background: #eee;
            border: 1px solid #ccc;
            border-radius: 5px;
            cursor: pointer;
            text-transform: uppercase;
        }
        .copy-btn:hover { background: #ddd; }
        
        /* Toast Notification */
        #toast {
            visibility: hidden;
            min-width: 200px;
            background-color: #333;
            color: #fff;
            text-align: center;
            border-radius: 25px;
            padding: 10px;
            position: fixed;
            z-index: 100;
            bottom: 30px;
            font-size: 0.9rem;
        }
        #toast.show { visibility: visible; animation: fadein 0.5s, fadeout 0.5s 2.5s; }
        @keyframes fadein { from {bottom: 0; opacity: 0;} to {bottom: 30px; opacity: 1;} }
        @keyframes fadeout { from {bottom: 30px; opacity: 1;} to {bottom: 0; opacity: 0;} }
    </style>
</head>
<body>

<header><h1>Google Professional Architect Certification Flashcards</h1></header>

<div class="controls">
    <select id="catSelect" class="btn" onchange="filterCards()"><option value="all">All Scenarios</option></select>
    <button class="btn" onclick="shuffle()">Shuffle</button>
    <button class="btn next" onclick="nextCard()">Next Scenario â†’</button>
</div>

<div class="card-container">
    <div class="card" id="cardElement" onclick="handleFlip(event)">
        <div class="face front">
            <div class="cat-tag" id="qTag">System</div>
            <div id="q">Searching for case_studies.js...</div>
        </div>
        <div class="face back">
            <button class="copy-btn" onclick="copyForGemini(event)">Copy</button>
            <div class="cat-tag" id="aTag">Solution</div>
            <div id="a"></div>
        </div>
    </div>
</div>

<div id="stat">Initializing...</div>
<div id="toast">Copied to Clipboard!</div>

<script src="case_studies.js"></script>

<script>
    let deck = [];
    let idx = 0;

    // Separate flip logic to allow button clicks inside the card
    function handleFlip(event) {
        if (event.target.tagName !== 'BUTTON') {
            document.getElementById('cardElement').classList.toggle('flipped');
        }
    }

    function copyForGemini(event) {
        event.stopPropagation(); // Prevents flipping when clicking copy
        const card = deck[idx];
        const textToCopy = `
GCP ARCHITECTURE SCENARIO:
Topic: ${card.cat}
Scenario: ${card.q}

PROPOSED SOLUTION:
Solution: ${card.a}
Flow: ${card.d}
Exam Tip: ${card.t}
Limits: ${card.l}
Challenge: ${card.c}
        `.trim();

        navigator.clipboard.writeText(textToCopy).then(() => {
            const toast = document.getElementById("toast");
            toast.className = "show";
            setTimeout(() => { toast.className = toast.className.replace("show", ""); }, 3000);
        });
    }

    function filterCards() {
        const cat = document.getElementById('catSelect').value;
        const all = window.masterData || [];
        deck = (cat === 'all') ? [...all] : all.filter(c => c.cat === cat);
        idx = 0;
        shuffle();
    }

    function shuffle() {
        if (deck.length > 1) {
            for (let i = deck.length - 1; i > 0; i--) {
                const j = Math.floor(Math.random() * (i + 1));
                [deck[i], deck[j]] = [deck[j], deck[i]];
            }
        }
        show();
    }

    function nextCard() {
        document.getElementById('cardElement').classList.remove('flipped');
        setTimeout(() => {
            if (deck.length > 0) {
                idx = (idx + 1) % deck.length;
                show();
            }
        }, 200);
    }

    function show() {
        const qDiv = document.getElementById('q');
        const aDiv = document.getElementById('a');
        if (!deck || deck.length === 0) {
            qDiv.innerText = "No data found. Ensure case_studies.js is in the same folder.";
            return;
        }
        const card = deck[idx];
        document.getElementById('qTag').innerText = card.cat;
        document.getElementById('aTag').innerText = card.cat + " Pattern";
        
        qDiv.innerHTML = card.q;
        aDiv.innerHTML = `
            <div style="font-weight:700; color:var(--g-green); font-size:1.2rem; padding-right:100px;">${card.a}</div>
            <div class="solution-flow"><b>Solution Flow:</b><br>${card.d.replace(/\n/g, '<br>')}</div>
            <div class="tip"><b>Exam Tip:</b> ${card.t}</div>
            <div class="meta-grid">
                <div class="meta-item limit"><b>Limits:</b><br>${card.l}</div>
                <div class="meta-item challenge"><b>Challenge:</b><br>${card.c}</div>
            </div>
        `;
        document.getElementById('stat').innerText = `Card ${idx + 1} of ${deck.length}`;
    }

    function startApp() {
        const data = window.masterData;
        if (!data || data.length === 0) {
            setTimeout(startApp, 500);
            return;
        }
        const cats = [...new Set(data.map(c => c.cat))].sort();
        const select = document.getElementById('catSelect');
        cats.forEach(c => {
            const opt = document.createElement('option');
            opt.value = c; opt.innerText = "Drill: " + c;
            select.appendChild(opt);
        });
        filterCards();
    }

    window.onload = startApp;
</script>

</body>
</html>